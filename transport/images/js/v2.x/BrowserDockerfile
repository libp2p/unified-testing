# Workaround: https://github.com/docker/cli/issues/996
ARG BASE_IMAGE=node-js-libp2p-head
FROM ${BASE_IMAGE}

WORKDIR /app

# Options: chromium, firefox, webkit
ARG BROWSER=chromium
ENV BROWSER=${BROWSER}

# Install Playwright browser at build time so it's not done during test run.
# Using 'playwright install' avoids loading the test suite (and get-libp2p.ts) during build.
RUN npx playwright install --with-deps $BROWSER

ENTRYPOINT ["sh", "-c", "npm test -- -t browser -- --browser \"$BROWSER\""]
